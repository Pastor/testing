<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Editor</title>
    <style type="text/css" media="screen">
        body {
            overflow: hidden;
        }

        #editor {
            margin: 0;
            /*position: absolute;*/
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
        }
    </style>
</head>
<body>

<pre id="editor">
    #include &lt;tcclib.h&gt;
    extern double sum(double a, double b);
    #ifdef _WIN32                           /* dynamically linked data needs 'dllimport' */
     __attribute__((dllimport))
    #endif
    extern const char hello_text[];
    int main(int argc, char **argv) {
        double r = sum(2, 3);
        printf("%s: %f\n", hello_text, r);
        return 3;
    }
}</pre>
<button onclick="send()">Send</button>

<script src="editor/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    const editor = ace.edit("editor");
    editor.setTheme("ace/theme/xcode");
    editor.session.setMode("ace/mode/c_cpp");
    editor.setOptions({
        maxLines: 25
    });

    function send() {
        const xhr = new XMLHttpRequest();
        xhr.open("POST", "/execute", true);
        xhr.setRequestHeader('Content-Type', 'application/octet-stream');
        xhr.send(editor.getValue());
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4) {
                console.log(xhr.responseText);
            }
            console.log(xhr.responseText);
        };
    }
</script>

</body>
</html>
